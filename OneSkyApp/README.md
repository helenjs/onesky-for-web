# Locale Widget for Web
Locale Widget written in JS

## Obfuscate and minify js code
```
npm -g install uglify-js
uglifyjs --compress --mangle -- src/js/app-api.js > src/js/app-api.min.js
uglifyjs --compress --mangle -- src/js/widget.js > src/js/widget.min.js
```

## Demos
- [Live demo (Anonymous user)](https://onesky.github.io/onesky-sdk-web/example_with_anonymous_user.html)
- [Live demo (Identified user)](https://onesky.github.io/onesky-sdk-web/example_with_identified_user.html)
- Live demo React (SPA)

## How it works

### Installation
To install the Locale widget, just import the JS libraries by pasting the following code snippets before the line of code. Please note that Locale Widget requires Locale.js, says

```
<script src="https://cdn.oneskyhq-stag.com/widget/cfad03c9-0071-4de4-a58c-71a0d4cd9f31"></script>
```

## Arguments for Widget.js to load an app
### Anonymous user
```
<script type="text/javascript">
    window.onesky = {
        app: {
            id: 'cfad03c9-0071-4de4-a58c-71a0d4cd9f31'
        }
    };
</script>
```

### Identify user
```
<script type="text/javascript">
    window.onesky = {
        app: {
            id: 'cfad03c9-0071-4de4-a58c-71a0d4cd9f31'
        },
        identifiedUser: {
            id: '123456',
            name: 'John Doe',
            email: 'johndoe@gmail.com',
            userHash: 'b613679a0814d9ec772f95d778c35fc5ff1697c493715653c6c712144292c5ad'
        }
    };
</script>
```

___
## React App - Installation
Go to the index.html ([example](https://github.com/onesky/onesky-sdk-web/blob/dev/react-example-app/public/index.html)) file and import the script

```
  <script src="https://cdn.oneskyhq-stag.com/widget/cfad03c9-0071-4de4-a58c-71a0d4cd9f31" crossorigin="anonymous"></script>

```

## Arguments for widget to load an app
### Anonymous user
```
<script type="text/javascript">
    window.onesky = {
        app: {
            id: 'cfad03c9-0071-4de4-a58c-71a0d4cd9f31'
        }
    };
</script>
```

### Identify user
```
<script type="text/javascript">
    window.onesky = {
        app: {
            id: 'cfad03c9-0071-4de4-a58c-71a0d4cd9f31'
        },
        identifiedUser: {
            id: '123456',
            name: 'John Doe',
            email: 'johndoe@gmail.com',
            userHash: 'b613679a0814d9ec772f95d778c35fc5ff1697c493715653c6c712144292c5ad'
        }
    };
</script>
```

## Add selector
Add ```<languageselector></languageselector>``` tag after ```<body>```

```
## Configuration of Widget.js
The configuration (window.OsConfig) controls the layout and default values for Widget.js, which is supposed to be generated by Widget Generation Service.

```
// Begin code-gen: Selector of app rule
console.log("Keep this placeholder mark for selectors code generation: begin");
window.OsSelectors = [{"type":"display-language","htmlTag":"languageselector","theme":"general","options":["en","es","zh"],"defaultValue":"en","respectOrder":["user-input","auto-detection"],"webTransitionMappings":[{"localeId":"en","location":"?lang=en"},{"localeId":"es","location":"?lang=es"},{"localeId":"zh","location":"?lang=zh"}],"isWebTransitionReloadPage":false,"isOnlineLocalization":true,"locales":[{"id":"en","displayName":"English","direction":"ltr"},{"id":"es","displayName":"español","direction":"ltr"},{"id":"zh","displayName":"中文","direction":"ltr"}],"css":""];
console.log("Keep this placeholder mark for selectors code generation: end");
// End code-gen: Selector of app rule

```
## User Hash
If user hash is not rendered to frontend, you can store it in the app locally once it is generated from your backend, so that it doesn't need to be requested for every request.
```

## Download source and translated string files from OneSky String API

#### NPM
Now running `npm start` or `npm run build` will engage your franken-config.

#### Yarn
Now running `yarn run` or `yarn build` will engage your franken-config.
